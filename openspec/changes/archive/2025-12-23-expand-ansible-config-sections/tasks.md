# Tasks: Expand `navigator_config.ansible_config` sections

- [x] 1. Identify the ansible-navigator v3.x schema expectations for `ansible.config` vs `ansible.config-override` and confirm the correct YAML nesting used by the plugin.
  - Validation: both provisioners generate `ansible-navigator.yml` with top-level `ansible-navigator:` and only set `ansible.config.path` (no `config-override` usage).
- [x] 2. Extend `AnsibleConfig` with typed nested structs for additional sections:
  - [x] 2.1 `privilege_escalation`
  - [x] 2.2 `persistent_connection`
  - [x] 2.3 `inventory`
  - [x] 2.4 `paramiko_connection`
  - [x] 2.5 `colors`
  - [x] 2.6 `diff`
  - [x] 2.7 `galaxy`
- [x] 3. Decide and document the initial field coverage per section (common options only) and ensure each field type aligns with intended HCL types.
  - Field coverage (initial):
    - `privilege_escalation`: `become` (bool), `become_method` (string), `become_user` (string)
    - `persistent_connection`: `connect_timeout` (int), `connect_retry_timeout` (int), `command_timeout` (int)
    - `inventory`: `enable_plugins` (list(string))
    - `paramiko_connection`: `proxy_command` (string)
    - `colors`: `force_color` (bool)
    - `diff`: `always` (bool), `context` (int)
    - `galaxy`: `server_list` (list(string)), `ignore_certs` (bool)
- [x] 4. Update `//go:generate packer-sdc mapstructure-to-hcl2` type list to include any new structs.
- [x] 5. Run `make generate` to regenerate `*.hcl2spec.go` and verify that the new blocks are accepted by HCL.
  - Validation: generated `provisioner.hcl2spec.go` files include `privilege_escalation` and other new nested blocks.
- [x] 6. Update ansible.cfg (INI) generation to render the new section blocks as INI sections, and ensure:
  - [x] 6.1 schema-compliant YAML (`ansible.config` contains only allowed keys)
  - [x] 6.2 nested blocks are rejected when `ansible_config.config` (path override) is set (existing mutual exclusivity requirement)
  - Validation: INI generation updated + mutual exclusivity enforced by `Config.Validate()` and unit tests.
- [x] 7. Add/extend unit tests for both provisioners validating:
  - [x] 7.1 HCL decoding for new blocks
  - [x] 7.2 ansible.cfg output contains expected sections/keys
  - [x] 7.3 ansible-navigator.yml references ansible.cfg via `ansible.config.path`
  - Validation: `go test ./...` passes.
- [x] 8. Add a minimal example HCL template exercising at least 2–3 new sections.
  - Added: [`example/ansible-config-sections.pkr.hcl`](packer/plugins/packer-plugin-ansible-navigator/example/ansible-config-sections.pkr.hcl:1)
- [x] 9. Update documentation (configuration reference + examples) to show the new section blocks and link to Ansible’s ansible.cfg reference.
  - Updated: [`docs/CONFIGURATION.md`](packer/plugins/packer-plugin-ansible-navigator/docs/CONFIGURATION.md:1), [`docs/EXAMPLES.md`](packer/plugins/packer-plugin-ansible-navigator/docs/EXAMPLES.md:1)
- [x] 10. Validation: run `go test ./...`, `go build ./...`, `make plugin-check`, and `packer validate` on the new example template.
  - Validation: `go test ./...`, `go build ./...`, `make plugin-check` succeeded; `packer validate` succeeded (after `make dev`, run from `example/`).
